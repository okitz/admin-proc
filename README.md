# 行政DXの定量評価：LLMとグラフ理論を用いた手続きコスト分析

## 1. 背景と目的
日本の行政DX（マイナンバー制度・マイナポータル）の進展により、オンライン申請が普及しつつある。しかし、単に「申請フォームがWeb化した」だけで、実際には「添付書類の画像撮影」「別途郵送」などの物理的工程が残り、市民の負担（フリクション）が解消されていないケースも散見される。
本プロジェクトは、自治体の「児童手当認定請求」の手続き案内（アナログ/デジタル）を対象に、LLMを用いて **「手続き依存グラフ」** として構造化し、グラフ理論およびコスト積算モデルを用いて、「行政手続きのデジタル化による負担軽減効果」を客観的・定量的に評価することを目的とする。

## 2. 利用データ
* **対象手続き:** 児童手当認定請求（第一子出生・転入時）
* **対象自治体:** 全国20〜30自治体（特別区、政令指定都市、地方都市をなど）
* **データソース:**
    * **アナログ:** 各自治体公式Webサイトの案内
    * **デジタル:** マイナポータル（ぴったりサービス）または自治体独自の電子申請システムのオンライン申請手続案内

* **ペルソナ設定:**
    * 比較条件を統一するため、「会社員（被用者保険）・第一子・同居」という標準的な申請者を想定する。

## 3. 手法
本研究では、非構造化テキストをLLMで解析し、有向グラフ（DAG）へ変換して分析を行う。

1.  **テキストの構造化:**
    * 収集したテキストデータをLLM (Gemini/GPT) に入力し、手続きのステップをノード、依存関係をエッジとするJSONデータを生成する。
    * 各ノードには、アクションの性質を示す **`Type`** (例: `Physical_Go`, `Digital_Input`) と、主体を示す **`Category`** (例: `Work`, `Wait`) を付与する。
2.  **重み付きコストモデル:**
    * 抽出された `Type` に基づき、標準的な所要時間（コスト）を重み付けする。
    * 例: 役所への移動(`Physical_Go`) = 30分, Web入力(`Digital_Input`) = 5分, マイナ署名(`Digital_Auth`) = 3分 等。

## 4. 分析内容
Python (NetworkX, Pandas, Matplotlib) を用いて以下の分析を行う。

1.  **総コスト比較:**
    * アナログ申請（郵送/窓口）とデジタル申請の「総所要時間」を比較し、削減率を算出する。
2.  **トポロジー分析:**
    * グラフの「ノード数（工程数）」や「複雑性」の変化を可視化する。
3.  **フリクション・要因分析:**
    * 「メディアスイッチング（紙⇔デジタルの変換）」の回数や、「外部依存（他機関からの書類取得）」の残存率を分析し、見せかけのDXと効果的なDXを分類する。

## 実装計画・実行手順

本プロジェクトは以下の3つのNotebookで構成・実行される。

### Step 1: データ収集とテキスト正規化
**ファイル名:** `01_data_collection.ipynb`

* **目的:** 自治体のWebサイトから必要なテキスト情報を抽出し、LLMに入力可能な形式（Markdown等）に整理して保存する。
* **主な処理:**
    1.  対象自治体リストの定義（ID, 自治体名, URL）。
    2.  Webスクレイピング（`BeautifulSoup`）または、PDF/画像からのテキスト抽出（OCRツール等の補助利用）。
        * *注: 構造が複雑なため、一部手動コピー＆ペーストによるテキストファイル作成も併用する。*
    3.  テキストの前処理（不要なヘッダー/フッター削除、表記ゆれ吸収）。
    4.  `data/raw_text/{city_id}_{type}.txt` への保存。

### Step 2: LLMによる依存関係グラフの抽出と構造化
**ファイル名:** `02_graph_extraction.ipynb`

* **目的:** 整理されたテキストをLLM APIに渡し、依存関係グラフ（JSON）を生成・保存する。
* **主な処理:**
    1.  **プロンプトエンジニアリング:**
        * ペルソナ（会社員・第一子）の指定。
        * アクション分類（`Physical_Go`, `Digital_Submit` 等）の定義定義。
        * 粒度制御（郵送準備のグルーピング、デジタル操作の分割）の指示。
    2.  **API実行:**
        * Gemini/OpenAI API をループ実行し、各自治体のテキストを処理。
    3.  **バリデーション:**
        * 出力されたJSONの構文チェック。
        * 必須キーの欠損チェック。
    4.  `data/processed_graph/{city_id}.json` への保存。

### Step 3: グラフ構築・コスト計算・統計分析
**ファイル名:** `03_analysis_visualization.ipynb`

* **目的:** JSONデータからグラフネットワークを構築し、定量的指標を算出して可視化する。
* **主な処理:**
    1.  **グラフ構築:**
        * `NetworkX` を用いて有向グラフオブジェクトを作成。
    2.  **コスト計算:**
        * 定義済みの「標準コストテーブル（Cost Table）」を適用し、各グラフの総コスト（Total Weight）を算出。
        * アナログ vs デジタルの削減率を計算。
    3.  **詳細分析:**
        * **要因分解:** コストの内訳（移動、入力、認証、待機）を積み上げ棒グラフで比較。
        * **自治体ランキング:** 削減率の高い順にランキング化。
        * **散布図:** 「アナログのコスト」vs「デジタルのコスト」プロットによるクラスタリング。
    4.  **結論の導出:**
        * 統計的検定（t検定など）を行い、レポート用図表を出力する。